Gemini
Conversation with Gemini
You said
can you explain this? is it true?

Since you're on Arch, you can set a Charge Limit to stop the battery at 80% if you're usually plugged in. This is the single best thing you can do for Framework battery longevity.

Gemini said
It is absolutely true. If you own a Framework Laptop and run Arch Linux, setting a battery charge limit is the most effective way to slow down chemical aging.

Here is the breakdown of why this works and how you can actually do it.

Why it works
Lithium-ion batteries are "stressed" when they are pushed to their physical limits—specifically when they are fully charged (100%) or completely empty (0%).

Heat & Voltage: Keeping a battery at 100% while plugged into wall power maintains high voltage and generates more heat, which degrades the battery's internal chemistry over time.

The "Sweet Spot": Most experts agree that keeping a battery between 20% and 80% significantly extends its cycle life.

Framework's Design: Framework laptops are designed to be user-repaired, but they also give you direct control over the hardware via the BIOS/Firmware, making this optimization very easy.

Is it "the best" thing you can do?
Yes. While keeping the laptop cool is also important, the constant "trickle charging" at 100% is the primary culprit for battery swelling and capacity loss in laptops that spend most of their lives on a desk.

How to do it on Arch Linux
Since you are on Arch, you have a few ways to handle this. You don't necessarily need a specific app; you can talk directly to the hardware.

1. The BIOS Method (Permanent)
This is the most reliable because it works regardless of your OS.

Restart your Framework and tap F2 to enter the BIOS.

Go to the Advanced or Battery section.

Look for Battery Charge Limit.

Set it to 80%.

2. The Linux Command Line (On the fly)
If you don't want to reboot, you can often set this via the terminal. Framework uses a standard interface for this. You can check your current limit with:

Bash
cat /sys/class/power_supply/BAT0/charge_control_end_threshold
To set it to 80, you would run (as root):

Bash
echo 80 | sudo tee /sys/class/power_supply/BAT0/charge_control_end_threshold
3. Using ectool (Advanced)
Many Arch users on Framework utilize the fw-ectool-git package from the AUR. This allows you to communicate with the Embedded Controller (EC) directly to manage power and fan curves.

Summary Table
Feature	Standard Behavior	With 80% Limit
Battery Lifespan	~2-3 years before noticeable drop	~5+ years before noticeable drop
Voltage Stress	High	Low
Daily Capacity	100% (Longer runtime today)	80% (Longer hardware life)
Pro Tip: If you know you have a long flight or a day of meetings coming up, you can simply toggle the limit back to 100% for that one day to get the extra runtime.

Would you like me to walk you through how to automate this setting so it persists every time you boot into Arch?

You said
and to toggle back to 100%, how would i do that?

Gemini said
To toggle back to 100%, you essentially just tell the system that the "end threshold" is 100. Since you're on Arch, you can do this instantly without a reboot.

The Manual Way
Run this command in your terminal to allow the battery to charge to its full capacity:

Bash
echo 100 | sudo tee /sys/class/power_supply/BAT0/charge_control_end_threshold
The "Arch Way" (Automation)
Since typing long file paths is tedious, most Arch users set up Aliases or a Systemd Service to handle this.

Option A: Create Bash Aliases (Easiest)
Add these to your .bashrc or .zshrc file. This lets you just type bat-full when you're packing your bag for a trip.

Open your config: nano ~/.bashrc

Add these lines at the bottom:

Bash
alias bat-safe="echo 80 | sudo tee /sys/class/power_supply/BAT0/charge_control_end_threshold"
alias bat-full="echo 100 | sudo tee /sys/class/power_supply/BAT0/charge_control_end_threshold"
Reload: source ~/.bashrc

Option B: Use TLP (Recommended)
If you aren't already using TLP for power management, it's the gold standard on Arch. It can manage these thresholds automatically.

Install it: sudo pacman -S tlp

Edit the config: sudo nano /etc/tlp.conf

Find and set these lines:

Plaintext
START_CHARGE_THRESH_BAT0=75
STOP_CHARGE_THRESH_BAT0=80
To temporarily charge to full: Simply run sudo tlp fullcharge. This will charge it to 100% once, and then revert to your 80% limit the next time you plug it in.

One thing to watch out for
When you toggle from 80% to 100%, the battery might stay at 80% for a minute or two before it starts climbing. This is normal—the charging controller is just recalibrating the current flow.

Would you like me to help you set up a simple script that asks you which mode you want every time you boot up?

You said
can you explain the use of tee in the above bash statement? why wouldn't I just pipe it?

Gemini said
This is a classic "Arch Linux rite of passage" question! The short answer is: Standard pipes (|) don't carry sudo privileges across the pipe.

When you try to redirect output to a system file, you hit a permissions wall because of how the shell handles redirection.

The Problem: Why sudo echo 80 > /sys/... fails
If you try this command, you will likely get a "Permission denied" error, even if you use sudo:

Bash
sudo echo 80 > /sys/class/power_supply/BAT0/charge_control_end_threshold
Here is why:

The shell (your terminal) sees the > symbol and tries to open the file for writing before it actually runs the command.

Your shell is running as a normal user, not root.

The shell fails to open the system file, so the command crashes before sudo even has a chance to execute the echo.

The Logic: Why tee works
The tee command is named after a T-junction in plumbing. It takes input from one source and "splits" it: it sends it to standard output (your screen) and writes it into a file.

When you use the command with tee, the logic changes:

Bash
echo 80 | sudo tee /sys/class/power_supply/BAT0/...
echo 80: Runs as a normal user (no special permissions needed to just "say" a number).

| (The Pipe): Passes that string "80" to the next command.

sudo tee: This is the magic part. The tee command is being run with root privileges. Because tee is the one actually opening and writing to the file, and tee has been given "superpowers" by sudo, the write is successful.

Summary Comparison
Method	Command Structure	Why it fails/works
Direct Redirection	sudo echo > file	The shell tries to open the file as a user; fails immediately.
The Pipe + Tee	echo | sudo tee file	The elevated process (tee) opens the file; succeeds.
The "Pro" Alternative
If you really hate tee and want to use a standard redirect, you have to wrap the entire command in a string and tell a root shell to execute it:

Bash
sudo bash -c "echo 80 > /sys/class/power_supply/BAT0/charge_control_end_threshold"
Note: This is generally considered more "messy" than the tee method because of the nested quotes.

Since you're tweaking battery settings, would you like me to show you how to check your battery's current "Health" (cycles and original vs. current capacity) via the terminal?





Gemini is AI and can make mistakes.


